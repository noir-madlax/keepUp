name: "OpenRouter"
site_id: "openrouter"
url: "https://openrouter.ai/settings/credits"
description: "监控 OpenRouter API Credits 余额 (简化版)"
icon_url: "https://openrouter.ai/favicon.ico"

steps:
  # 1. 导航到 Credits 页面
  - action: "navigate"
    url: "https://openrouter.ai/settings/credits"
    wait_for: "networkidle2"
    timeout: 30000
    comment: "访问 OpenRouter Credits 设置页面"

  # 2. 等待页面加载完成（使用 networkidle2 已经足够）
  # 不再等待特定元素，因为可能被 Cloudflare 拦截或元素动态加载

  # 3. 调试截图 - 查看实际页面状态
  - action: "screenshot"
    full_page: true
    comment: "完整截图用于调试（查看是否 Cloudflare 拦截）"

  # 4. 提取 Credits 余额
  # 目标 div: <div class="group/card rounded-xl..." aria-label="Remaining credits: 7.725">
  # 直接从 aria-label 属性提取数值，避免处理内部复杂的数字动画
  - action: "extract"
    name: "credits"
    selector: "div[aria-label*='Remaining credits']"
    extract_type: "attribute"
    attribute: "aria-label"
    regex_pattern: "Remaining credits:\\s*([\\d.]+)"
    regex_group: 1
    transform: "float"
    comment: "从 aria-label 属性中提取 Credits 余额"

  # 5. 截图
  - action: "screenshot"
    full_page: false
    comment: "截取页面"

# Cookie 验证配置
validation:
  cookie_check:
    selector: "div[aria-label*='Remaining']"
    should_exist: true

