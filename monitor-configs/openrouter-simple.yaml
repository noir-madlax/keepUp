name: "OpenRouter"
site_id: "openrouter"
url: "https://openrouter.ai/settings/credits"
description: "监控 OpenRouter API Credits 余额 (简化版)"
icon_url: "https://openrouter.ai/favicon.ico"

steps:
  # 1. 导航到 Credits 页面
  - action: "navigate"
    url: "https://openrouter.ai/settings/credits"
    wait_for: "networkidle2"
    timeout: 30000
    comment: "访问 OpenRouter Credits 设置页面"

  # 2. 等待页面加载完成
  - action: "wait"
    selector: "body"
    timeout: 10000
    comment: "等待页面基本加载"

  # 3. 额外等待页面完全渲染
  - action: "wait"
    selector: ".text-4xl"
    timeout: 20000
    comment: "等待价格显示元素加载"

  # 4. 再等待一下确保动画完成
  - action: "wait"
    selector: ".rounded-xl"
    timeout: 15000
    comment: "等待卡片元素完全加载"

  # 5. 提取 Credits 余额
  # 目标 div 结构: <div class="group/card rounded-xl..." aria-label="Remaining credits: 7.733">
  # 内部有复杂的数字滚动动画，但 aria-label 包含实际值
  - action: "extract"
    name: "credits"
    selector: "div[aria-label*='Remaining credits']"
    extract_type: "attribute"
    attribute: "aria-label"
    regex_pattern: "Remaining credits:\\s*([\\d.]+)"
    regex_group: 1
    transform: "float"
    comment: "从 aria-label 属性中提取 Credits 余额"

  # 6. 截图
  - action: "screenshot"
    full_page: false
    comment: "截取页面"

# Cookie 验证配置
validation:
  cookie_check:
    selector: ".text-4xl"
    should_exist: true

